import{_ as s,c as l,o as u,a as o,m as p,n as d}from"./main-wZxHusq7.js";const h={props:{content:{type:Object,required:!0},uid:{type:String,required:!0}},emits:["update:sidepanel-content","trigger-event"],setup(e){const{variableValue:i,setValue:r}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"Is Playing",type:"boolean",defaultValue:!1,readonly:!0}),{variableValue:a,setValue:t}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"Current time",type:"number",defaultValue:0,readonly:!0});return{player:null,isPlayingVariableValue:i,setIsPlayingValue:r,currentTimeVariableValue:a,setCurrentTimeValue:t}},computed:{isEditing(){return!1},isPreviewImageWeWeb(){return this.content.previewImage&&this.content.previewImage.startsWith("designs/")},previewImageSrc(){return this.isPreviewImageWeWeb?`${wwLib.wwUtils.getCdnPrefix()}${this.content.previewImage}`:this.content.previewImage},videoAttributes(){return{src:this.content.file,poster:this.previewImageSrc,muted:this.content.muted,autoplay:this.isEditing?!1:this.content.autoplay,controls:this.content.controls,loop:this.content.loop,preload:this.content.preload}}},watch:{isEditing(){this.initVideo()},"content.file"(){this.initVideo()},"content.autoplay"(e){this.content.muted||this.$emit("update:content",{muted:!0}),this.player&&e&&!this.isEditing&&this.player.play()}},mounted(){this.initVideo()},methods:{initVideo(){this.player=this.$refs.videoPlayer,this.player&&(this.player.pause(),this.player.currentTime=Math.ceil(this.content.videoStartTime),!this.isEditing&&(this.player.ontimeupdate=e=>{this.updateCurrentTime(e.target.currentTime)},this.player.onplay=()=>this.updateIsPlaying(!0),this.player.onpause=()=>this.updateIsPlaying(!1),this.player.onended=()=>this.$emit("trigger-event",{name:"end",event:{value:this.player.currentTime}}),this.$nextTick(()=>{this.content.autoplay&&this.player.play()})))},updateCurrentTime(e){typeof e=="number"&&this.setCurrentTimeValue(e.toFixed(2))},updateIsPlaying(e){this.setIsPlayingValue(e),e?this.$emit("trigger-event",{name:"play",event:{value:this.player.currentTime}}):this.$emit("trigger-event",{name:"pause",event:{value:this.player.currentTime}})},playVideo(){this.player&&this.player.play()},pauseVideo(){this.player&&this.player.pause()},seekTo(e){this.player&&(this.player.currentTime=Math.ceil(e))}}};function c(e,n,i,r,a,t){return u(),l("div",{class:d(["ww-video-weweb",{editing:t.isEditing}])},[o("video",p({ref:"videoPlayer",class:"video-element",playsinline:"","webkit-playsinline":""},t.videoAttributes)," Sorry, your browser doesn't support embedded videos. ",16)],2)}const y=s(h,[["render",c]]);export{y as e};
