import{_ as a,c,o,b as u,n as d}from"./main-BsligTLj.js";const h=/.*?src="(.*?)"/gim,l=/.*?charset="(.*?)"/gim,w=/<script.*>(.*)<\/script>/gim,_={props:{content:{type:Object,required:!0},uid:{type:String,required:!0}},emits:["update:content"],data(){return{reset:!1}},computed:{isEditing(){return!1},source(){return this.reset?null:this.content.source?this.content.source:null},scripts(){return typeof this.content.source!="string"?[]:[...this.content.source.matchAll(/<script.*?>.*?<\/script>/gim)].map(e=>e[0]).map(e=>{const r=new RegExp(h).exec(e),s=new RegExp(l).exec(e),i=new RegExp(w).exec(e);return{src:r&&r[1],charset:s&&s[1],async:e.includes(" async"),content:i&&i[1],attributes:{"ww-html-uid":this.uid}}})}},mounted(){this.init(),wwLib.getFrontWindow().addEventListener("resize",this.reinit)},watch:{scripts(){this.init()},isEditing(t){t||this.init()}},methods:{async init(){try{await this.loadScripts(),this.executeJavascript()}catch(t){wwLib.wwLog.error(t,"error")}},async loadScripts(){if(!window.__WW_IS_PRERENDER__)return wwLib.getFrontDocument().head.querySelectorAll(`script[ww-html-uid="${this.uid}"]`).forEach(t=>t.remove()),Promise.all(this.scripts.filter(t=>t.src).map(t=>wwLib.wwUtils.addScriptToHead({link:t.src,async:t.async,charset:t.charset,attributes:t.attributes},!0)))},executeJavascript(){window.__WW_IS_PRERENDER__||this.scripts.filter(t=>t.content).forEach(t=>{new Function(t.content)()})},reinit(){this.content.refreshOnResize&&(this.reset=!0,this.$nextTick(()=>{this.reset=!1,this.init()}))}},beforeUnmount(){wwLib.getFrontWindow().removeEventListener("resize",this.reinit)}},p=["innerHTML"];function m(t,e,r,s,i,n){return o(),c("div",{ref:"html",class:d(["ww-html",{isEditing:n.isEditing}])},[n.source?(o(),c("div",{key:0,class:"html-holder",innerHTML:n.source},null,8,p)):u("",!0)],2)}const f=a(_,[["render",m],["__scopeId","data-v-b9c53045"]]);export{f as e};
