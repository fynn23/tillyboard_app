import{_ as S,D as y,j as x,o as V,J as h,H as g,a as j,n as C,i as n}from"./main-wZxHusq7.js";import{e as D}from"./wwElement-BR8yUwQe.js";import{e as K}from"./wwElement-XXXD_DmL.js";import{e as L}from"./wwElement-DkBwuXji.js";import{e as k,a as A,b as $,c as H,d as P,f as N,g as q,h as R,i as O,j as U}from"./wwElement-DwjKoJSM.js";import{e as T}from"./wwElement-qzjwZ9St.js";import{e as B}from"./wwElement-DFSfmJJY.js";import{e as F,s as M}from"./wwSection-D3CfB-8z.js";import{e as z}from"./wwElement-C2BwhOrC.js";import{d as E}from"./vuedraggable.umd-BI2gBd4E.js";import{e as J}from"./wwElement-BbtIwH60.js";import{e as G}from"./wwElement-C492LV0B.js";import{e as Q}from"./wwElement-BtT12Qlq.js";import{e as W}from"./wwElement-DHx8gZD8.js";import{e as X}from"./wwElement-CtBi82F3.js";import{e as Y}from"./wwElement-mMetspxY.js";import{e as Z}from"./wwElement-B9LA9CRL.js";import{e as ee}from"./wwElement-BN5nUlEf.js";import{e as te,a as ae}from"./wwElement-D3Z2Rwe5.js";import{e as ne}from"./wwElement-DyRADdDd.js";import{e as oe}from"./wwElement-INvhjNJM.js";import{e as se}from"./wwElement-imBWisAs.js";import{e as re}from"./wwElement-BOfl3FSq.js";import{e as le}from"./wwElement-DNO0PYhM.js";import{e as ie}from"./wwElement-DOFxFSCE.js";import{e as de}from"./wwElement-Dovj2niU.js";import{e as ce}from"./wwElement-DuX58JhT.js";import{s as me}from"./wwSection-5kSUtEsV.js";import"./default.css_vue_type_style_index_0_src_true_lang-DsaiX_Uw.js";import"./index-kmzByEC2.js";const we={components:{draggable:E},inject:{customHandler:{defaultValue:null},customDragHandler:{defaultValue:null}},props:{wwElementState:{type:Object,required:!0},content:{type:Object,required:!0},uid:{type:String,required:!0}},emits:["trigger-event"],setup(e){const{value:a,setValue:r}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"isDragging",type:"boolean",defaultValue:!1,readonly:!0});return{isDragging:a,setDrag:r}},data:()=>({internalItems:[],draggedItem:null}),methods:{clone(e){if(e&&typeof e=="object"){const a={...e};return delete a.__draggable_context,a}return e},onChange(e){this.customHandler&&this.customHandler(e,{...this.wwElementState.props,updatedStackItems:this.internalItems}),e.moved&&this.$emit("trigger-event",{name:"item:moved",event:{item:e.moved.element,oldIndex:e.moved.oldIndex,newIndex:e.moved.newIndex,updatedList:this.internalItems}}),e.added&&this.$emit("trigger-event",{name:"item:added",event:{item:e.added.element,newIndex:e.added.newIndex,updatedList:this.internalItems}}),e.removed&&this.$emit("trigger-event",{name:"item:removed",event:{item:e.removed.element,oldIndex:e.removed.oldIndex,updatedList:this.internalItems}})},getItemValue(e){var r,d;if(!e)return"";const a=((r=this.wwElementState.props)==null?void 0:r.allowKey)||((d=this.content)==null?void 0:d.allowKey)||"type";return e[a]||""},isAllowed(e){var i,t,w,o;if(!e)return!0;const a=((i=this.wwElementState.props)==null?void 0:i.allowKey)||((t=this.content)==null?void 0:t.allowKey)||"type",r=((w=this.wwElementState.props)==null?void 0:w.allowValues)||((o=this.content)==null?void 0:o.allowValues)||"";return r?r.split(",").map(c=>c.trim()).includes(String(e[a])):!0},setupPreDragCheck(){this.$el&&(this.$el.removeEventListener("pointerdown",this.handlePreDragCheck,{passive:!1}),this.$el.removeEventListener("mousedown",this.handlePreDragCheck,{passive:!1}),this.$el.removeEventListener("touchstart",this.handlePreDragCheck,{passive:!1}),this.$el.addEventListener("pointerdown",this.handlePreDragCheck,{passive:!1}),this.$el.addEventListener("mousedown",this.handlePreDragCheck,{passive:!1}),this.$el.addEventListener("touchstart",this.handlePreDragCheck,{passive:!1}))},handlePreDragCheck(e){var t;const a=(t=e.target)==null?void 0:t.closest(".draggable-item");if(!a)return;const d=Array.from(this.$el.querySelectorAll(".draggable-item")).indexOf(a);if(d===-1)return;const i=this.internalItems[d];i&&(this.isAllowed(i)||(e.preventDefault(),e.stopPropagation(),this.$emit("trigger-event",{name:"item:rejected",event:{item:i,reason:"value-restricted"}})))},onStart(e){if(!e)return;const a=this.internalItems[e.oldIndex];if(!this.isAllowed(a))return e.preventDefault(),!1;this.draggedItem=a,this.setDrag(!0)},onEnd(){this.draggedItem=null,this.setDrag(!1)},onChoose(e){if(!e)return;const a=this.internalItems[e.oldIndex];if(!this.isAllowed(a))return e.preventDefault(),!1},onMove(e){var d,i,t,w;if(!e)return!0;let a=null;try{if(this.draggedItem)a=this.draggedItem;else if(e.draggedContext&&e.draggedContext.element)a=e.draggedContext.element;else if(e.draggedEl&&e.draggedEl.dataset&&e.draggedEl.dataset.index){const o=parseInt(e.draggedEl.dataset.index,10);!isNaN(o)&&Array.isArray(e.from.list)&&o>=0&&o<e.from.list.length&&(a=e.from.list[o])}}catch(o){console.warn("Error accessing dragged item:",o)}let r=[];try{const o=e.to&&e.to.el?e.to.el.closest("[data-element-id]"):null;if(o){const c=window.wwLib.getElement(o.dataset.elementId);if(c){const u=((d=c.content)==null?void 0:d.allowKey)||"type",l=((i=c.content)==null?void 0:i.allowValues)||"";l&&(r=l.split(",").map(b=>b.trim()))}}}catch(o){console.warn("Error accessing target container's allowed values:",o)}if(a&&r.length>0){const o=((t=this.wwElementState.props)==null?void 0:t.allowKey)||((w=this.content)==null?void 0:w.allowKey)||"type",c=String(a[o]||"");if(!r.includes(c))return this.$emit("trigger-event",{name:"item:rejected",event:{item:a,reason:"target-container-restriction"}}),!1}return!0}},computed:{isEditing(){return!1},items(){var r,d;const e=(r=this.wwElementState.props)!=null&&r.items?this.wwElementState.props.items:(d=this.content)==null?void 0:d.items,a=wwLib.wwUtils.getDataFromCollection(e);return Array.isArray(a)?a:[]},group(){var a,r;const e=(a=this.wwElementState.props)!=null&&a.group?this.wwElementState.props.group:(r=this.content)==null?void 0:r.group;return typeof e=="string"?{name:e,put:(d,i,t,w)=>{var o,c,u,l,b,f;try{let m="";if(t&&t.dataset&&t.dataset.value)m=t.dataset.value;else if(t&&t.dataset&&t.dataset.index){const s=parseInt(t.dataset.index,10);if(!isNaN(s)&&Array.isArray(i.list)&&s>=0&&s<i.list.length){const p=i.list[s],I=((o=this.wwElementState.props)==null?void 0:o.allowKey)||((c=this.content)==null?void 0:c.allowKey)||"type";m=String(p[I]||"")}}else if(t&&t.__draggable_context&&t.__draggable_context.element){const s=t.__draggable_context.element,p=((u=this.wwElementState.props)==null?void 0:u.allowKey)||((l=this.content)==null?void 0:l.allowKey)||"type";m=String(s[p]||"")}const _=((b=this.wwElementState.props)==null?void 0:b.allowValues)||((f=this.content)==null?void 0:f.allowValues)||"";return _?_.split(",").map(s=>s.trim()).includes(m):!0}catch(m){return console.warn("Error in group.put function:",m),!0}}}:typeof e=="object"&&e!==null?{...e,put:(d,i,t,w)=>{var o,c,u,l,b,f;try{let m="";if(t&&t.dataset&&t.dataset.value)m=t.dataset.value;else if(t&&t.dataset&&t.dataset.index){const s=parseInt(t.dataset.index,10);if(!isNaN(s)&&Array.isArray(i.list)&&s>=0&&s<i.list.length){const p=i.list[s],I=((o=this.wwElementState.props)==null?void 0:o.allowKey)||((c=this.content)==null?void 0:c.allowKey)||"type";m=String(p[I]||"")}}else if(t&&t.__draggable_context&&t.__draggable_context.element){const s=t.__draggable_context.element,p=((u=this.wwElementState.props)==null?void 0:u.allowKey)||((l=this.content)==null?void 0:l.allowKey)||"type";m=String(s[p]||"")}const _=((b=this.wwElementState.props)==null?void 0:b.allowValues)||((f=this.content)==null?void 0:f.allowValues)||"";return _?_.split(",").map(s=>s.trim()).includes(m):!0}catch(m){return console.warn("Error in group.put function:",m),!0}}}:{name:"common",put:(d,i,t,w)=>{var o,c,u,l,b,f;try{let m="";if(t&&t.dataset&&t.dataset.value)m=t.dataset.value;else if(t&&t.dataset&&t.dataset.index){const s=parseInt(t.dataset.index,10);if(!isNaN(s)&&Array.isArray(i.list)&&s>=0&&s<i.list.length){const p=i.list[s],I=((o=this.wwElementState.props)==null?void 0:o.allowKey)||((c=this.content)==null?void 0:c.allowKey)||"type";m=String(p[I]||"")}}else if(t&&t.__draggable_context&&t.__draggable_context.element){const s=t.__draggable_context.element,p=((u=this.wwElementState.props)==null?void 0:u.allowKey)||((l=this.content)==null?void 0:l.allowKey)||"type";m=String(s[p]||"")}const _=((b=this.wwElementState.props)==null?void 0:b.allowValues)||((f=this.content)==null?void 0:f.allowValues)||"";return _?_.split(",").map(s=>s.trim()).includes(m):!0}catch(m){return console.warn("Error in group.put function:",m),!0}}}},sortable(){var e,a;return((e=this.wwElementState.props)==null?void 0:e.sortable)!==void 0?this.wwElementState.props.sortable:(a=this.content)==null?void 0:a.sortable},itemKey(){var e;return((e=this.wwElementState.props)==null?void 0:e.itemKey)||"id"},handle(){var e,a,r,d;return(a=(e=this.wwElementState.props)==null?void 0:e.handle)!=null&&a.length?this.wwElementState.props.handle:(r=this.content)!=null&&r.customDragHandle?((d=this.content)==null?void 0:d.handleClass)||"draggable":null},isReadonly(){var e,a;return!!((e=this.wwElementState.props)!=null&&e.readonly||(a=this.content)!=null&&a.readonly)}},watch:{items:{immediate:!0,deep:!0,handler:function(e){this.internalItems=Array.isArray(e)?[...e]:[]}},isDragging(e){this.customDragHandler&&this.customDragHandler(e,{...this.wwElementState.props})},isReadonly:{immediate:!0,handler(e){e?this.$emit("add-state","readonly"):this.$emit("remove-state","readonly")}},"content.allowKey":function(){this.$nextTick(()=>{this.internalItems=[...this.internalItems]})},"content.allowValues":function(){this.$nextTick(()=>{this.internalItems=[...this.internalItems]})},"wwElementState.props.allowKey":function(){this.$nextTick(()=>{this.internalItems=[...this.internalItems]})},"wwElementState.props.allowValues":function(){this.$nextTick(()=>{this.internalItems=[...this.internalItems]})}},mounted(){this.setupPreDragCheck()},beforeUnmount(){this.$el&&(this.$el.removeEventListener("pointerdown",this.handlePreDragCheck),this.$el.removeEventListener("mousedown",this.handlePreDragCheck),this.$el.removeEventListener("touchstart",this.handlePreDragCheck))}},ue=["data-index","data-value"];function be(e,a,r,d,i,t){var u;const w=y("wwLayout"),o=y("wwLayoutItemContext"),c=y("draggable");return V(),x(c,{modelValue:e.internalItems,"onUpdate:modelValue":a[0]||(a[0]=l=>e.internalItems=l),"item-key":t.itemKey,clone:t.clone,group:t.group,sort:t.sortable,animation:200,handle:(u=t.handle)!=null&&u.length?`.${t.handle}`:null,disabled:t.isEditing||t.isReadonly,"ghost-class":"ghost",onChange:t.onChange,onStart:t.onStart,onEnd:t.onEnd,onChoose:t.onChoose,move:t.onMove},{header:h(()=>[g(w,{path:"headerElement"})]),item:h(({element:l,index:b})=>[j("div",{class:C(["draggable-item",{"draggable-item--disabled":!t.isAllowed(l)}]),"data-index":b,"data-value":t.getItemValue(l)},[g(o,{index:b,item:null,"is-repeat":"",data:l,"repeated-items":e.internalItems},{default:h(()=>[g(w,{path:"itemElement"})]),_:2},1032,["index","data","repeated-items"])],10,ue)]),footer:h(()=>[g(w,{path:"footerElement"})]),_:1},8,["modelValue","item-key","clone","group","sort","handle","disabled","onChange","onStart","onEnd","onChoose","move"])}const pe=S(we,[["render",be],["__scopeId","data-v-66973670"]]),fe={components:{draggable:E},inject:{customHandler:{defaultValue:null},customDragHandler:{defaultValue:null}},props:{wwElementState:{type:Object,required:!0},content:{type:Object,required:!0},uid:{type:String,required:!0}},emits:["trigger-event"],setup(e){const{value:a,setValue:r}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"isDragging",type:"boolean",defaultValue:!1,readonly:!0});return{isDragging:a,setDrag:r}},data:()=>({internalItems:[]}),methods:{onChange(e){this.customHandler&&this.customHandler(e,{...this.wwElementState.props,updatedStackItems:this.internalItems}),e.moved&&this.$emit("trigger-event",{name:"item:moved",event:{item:e.moved.element,oldIndex:e.moved.oldIndex,newIndex:e.moved.newIndex,updatedList:this.internalItems}}),e.added&&this.$emit("trigger-event",{name:"item:added",event:{item:e.added.element,newIndex:e.added.newIndex,updatedList:this.internalItems}}),e.removed&&this.$emit("trigger-event",{name:"item:removed",event:{item:e.removed.element,oldIndex:e.removed.oldIndex,updatedList:this.internalItems}})}},computed:{isEditing(){return!1},items(){const e=this.wwElementState.props.items?this.wwElementState.props.items:this.content.items,a=wwLib.wwUtils.getDataFromCollection(e);return Array.isArray(a)?a:[]},group(){return this.wwElementState.props.group?this.wwElementState.props.group:this.content.group},sortable(){return this.wwElementState.props.sortable?this.wwElementState.props.sortable:this.content.sortable},itemKey(){return this.wwElementState.props.itemKey||"id"},handle(){var e;return(e=this.wwElementState.props.handle)!=null&&e.length?this.wwElementState.props.handle:this.content.customDragHandle?this.content.handleClass||"draggable":null},isReadonly(){return!!(this.wwElementState.props.readonly||this.content.readonly)}},watch:{items:{immediate:!0,deep:!0,handler:function(e){this.internalItems=[...e]}},isDragging(e){this.customDragHandler&&this.customDragHandler(e,{...this.wwElementState.props})},isReadonly:{immediate:!0,handler(e){e?this.$emit("add-state","readonly"):this.$emit("remove-state","readonly")}}}},_e={class:"draggable-item"};function he(e,a,r,d,i,t){var u;const w=y("wwLayout"),o=y("wwLayoutItemContext"),c=y("draggable");return V(),x(c,{modelValue:e.internalItems,"onUpdate:modelValue":a[0]||(a[0]=l=>e.internalItems=l),"item-key":t.itemKey,clone:l=>l,group:t.group,sort:t.sortable,animation:200,handle:(u=t.handle)!=null&&u.length?`.${t.handle}`:null,disabled:t.isEditing||t.isReadonly,"ghost-class":"ghost",onChange:t.onChange,onStart:a[1]||(a[1]=l=>d.setDrag(!0)),onEnd:a[2]||(a[2]=l=>d.setDrag(!1))},{header:h(()=>[g(w,{path:"headerElement"})]),item:h(({element:l,index:b})=>[j("div",_e,[g(o,{index:b,item:null,"is-repeat":"",data:l,"repeated-items":e.internalItems},{default:h(()=>[g(w,{path:"itemElement"})]),_:2},1032,["index","data","repeated-items"])])]),footer:h(()=>[g(w,{path:"footerElement"})]),_:1},8,["modelValue","item-key","clone","group","sort","handle","disabled","onChange"])}const ge=S(fe,[["render",he],["__scopeId","data-v-f9a74239"]]);n.component("wwobject-0ca4e3ac-3c7b-4e1c-bf4e-b87d5ed302b3",D);n.component("wwobject-0d3e75d1-9e77-44cb-a272-8b0825fbc5da",K);n.component("wwobject-14723a21-0178-4d92-a7e9-d1dfeaec29a7",L);n.component("wwobject-1b1e2173-9b78-42cc-a8ee-a6167caea340",k);n.component("wwobject-1ba25bdf-dee9-4e0e-a0b8-b3f3128c3b65",A);n.component("wwobject-21881619-a984-4847-81a9-922c3dbb5853",T);n.component("wwobject-2d18ef4c-e9e5-4dc6-a29d-01d9f797be5e",B);n.component("wwobject-3a7d6379-12d3-4387-98ff-b332bb492a63",F);n.component("wwobject-53401515-b694-4c79-a88d-abeecb1de562",z);n.component("wwobject-5b61c2ee-96e3-402f-9f64-596f5e3002f2",pe);n.component("wwobject-5c57cd3e-0efb-451f-872a-17f0583ef682",ge);n.component("wwobject-6145eb60-0af8-4e52-bcc6-dc0f6743654e",$);n.component("wwobject-61825dc3-96de-46e1-a8c4-b091289d8448",J);n.component("wwobject-69d0b3ef-b265-494c-8cd1-874da4aa1834",G);n.component("wwobject-6ba133b6-a444-414f-93a5-25cd237dd398",Q);n.component("wwobject-6f8796b1-8273-498d-95fc-7013b7c63214",W);n.component("wwobject-73a13eff-bdc7-4021-bdc6-413c97fe91c1",X);n.component("wwobject-83d890fb-84f9-4386-b459-fb4be89a8e15",Y);n.component("wwobject-85044fa4-8fc0-4115-9eaf-ca30a1b4b528",Z);n.component("wwobject-9256b033-f4e8-4ab4-adce-dac3a940d7f5",ee);n.component("wwobject-97a63460-5c25-4d74-ac1f-86693c2e4a08",te);n.component("wwobject-985570fc-b3c0-4566-8004-82ab3b30a11d",ne);n.component("wwobject-9ae1fce8-2e31-4bfd-a4d2-0450235bdfd5",oe);n.component("wwobject-9ecb2cfc-cef7-4be8-b736-3e17a3b7e9ff",H);n.component("wwobject-9f3c91ad-1667-473e-b530-521daa099a14",se);n.component("wwobject-a6cb6a4d-6af7-4cd6-b530-a15d9ec64488",P);n.component("wwobject-a823467c-bdc7-4cec-a38c-71875c4c214a",re);n.component("wwobject-aa27b26f-0686-4c29-98c5-8217044045b7",le);n.component("wwobject-aa29a661-07ce-484e-8abb-456186211282",ae);n.component("wwobject-af811adf-94d9-49dd-ab22-e2f29ae30299",ie);n.component("wwobject-b783dc65-d528-4f74-8c14-e27c934c39b1",N);n.component("wwobject-c6c0c00e-49fd-4cb9-bd78-5bc09945721e",q);n.component("wwobject-d7904e9d-fc9a-4d80-9e32-728e097879ad",R);n.component("wwobject-deb10a01-5eef-4aa1-9017-1b51c2ad6fd0",O);n.component("wwobject-e2962a22-03b3-4421-b85e-906177d2303f",de);n.component("wwobject-f4c24d06-bc88-4b62-add3-4d1f8b42221c",U);n.component("wwobject-fd8c482f-532c-4aeb-a7ae-6904a6b62a1b",ce);n.component("section-99586bd3-2b15-4d6b-a025-6a50d07ca845",M);n.component("section-ef0ecc71-9a59-4eab-94b0-b36d66d3d61d",me);
