import{_ as p,D as v,c as o,o as u,b as y,m as d,d as b,H as w,e as c,r as g,p as E}from"./main-BsligTLj.js";const m=["padding","border","borderLeft","borderRight","borderTop","borderBottom","borderRadius","background","boxShadow","cursor"],x={inheritAttrs:!1,props:{content:{type:Object,required:!0},uid:{type:String,required:!0},wwElementState:{type:Object,required:!0}},emits:["trigger-event","add-state","remove-state","update:content:effect"],setup(e){const t=c(()=>Object.keys(e.wwElementState.props).includes("type")?e.wwElementState.props.type:e.content.type),n=c(()=>["decimal","number"].includes(t.value)?e.content.step:t.value==="time"&&e.content.timePrecision||1);function s(l){if(t.value!=="decimal")return l;if(!l&&l!==0)return"";l=`${l}`.replace(",",".");const f=l.indexOf(".")!==-1?e.content.precision.split(".")[1].length:0;return parseFloat(Number(l).toFixed(f).replace(",","."))}const{value:r,setValue:i}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"value",type:c(()=>["decimal","number"].includes(t.value)?"number":"string"),defaultValue:c(()=>e.content.value===void 0?"":s(e.content.value))}),h=g("input"),a=E("componentState",{});return{variableValue:r,setValue:i,formatValue:s,step:n,type:t,inputRef:h,state:a}},data(){return{paddingLeft:"0px",placeholderPosition:{top:"0px",left:"0px"},isReallyFocused:!1,noTransition:!1,isMounted:!1,isDebouncing:!1}},computed:{isEditing(){return!1},value(){return this.variableValue},delay(){return wwLib.wwUtils.getLengthUnit(this.content.debounceDelay)[0]},placeholderSyle(){var n,s,r,i;const e=`all ${this.noTransition?"0ms":this.content.transition} ${this.content.timingFunction}`,t=this.content.placeholderPosition==="outside"?{top:"-"+this.content.positioningAjustment,left:this.placeholderPosition.left,transform:`translate3d(0, -100%, 0) scale(${this.content.placeholderScaling})`,transformOrigin:"left",transition:e}:{top:this.content.positioningAjustment,left:this.placeholderPosition.left,transform:`translate3d(0, 0%, 0) scale(${this.content.placeholderScaling})`,transformOrigin:"left",transition:e};return this.content.forceAnimation&&this.isEditing||this.value||this.value===0||(t.cursor=((s=(n=this.$attrs)==null?void 0:n.style)==null?void 0:s.cursor)||"text",this.isDebouncing)||this.content.animationTrigger==="focus"&&this.isFocused?t:{top:this.placeholderPosition.top,left:this.placeholderPosition.left,userSelect:"none",transform:"translate3d(0, 0%, 0) scale(1)",transformOrigin:"left",transition:e,cursor:((i=(r=this.$attrs)==null?void 0:r.style)==null?void 0:i.cursor)||"text"}},rootBinding(){var s;const e={...this.$attrs.style||{}};m.forEach(r=>{delete e[r]});let t={};for(const r in this.$attrs)(((s=this.state)==null?void 0:s.attributes)||[]).some(i=>i.name===r)||(t[r]=this.$attrs[r]);const n={...t,style:e};return delete n.id,delete n.class,n},inputBinding(){var t;return{...(((t=this.state)==null?void 0:t.attributes)||[]).reduce((n,s)=>(n[s.name]=s.value,n),{}),...this.wwElementState.props.attributes||{}}},style(){const e={...wwLib.wwUtils.getTextStyleFromContent(this.content),"--placeholder-color":this.content.placeholderColor};return delete e.whiteSpaceCollapse,delete e.whiteSpace,m.forEach(t=>{var n,s,r,i;(s=(n=this.$attrs)==null?void 0:n.style)!=null&&s[t]&&(e[t]=(i=(r=this.$attrs)==null?void 0:r.style)==null?void 0:i[t])}),e},inputType(){return this.content?this.content.type==="password"?this.content.displayPassword?"text":"password":this.content.type==="decimal"?"number":this.content.type:"text"},isReadonly(){return this.wwElementState.props.readonly===void 0?this.content.readonly:this.wwElementState.props.readonly},isFocused(){return this.isReallyFocused},isAdvancedPlaceholder(){return this.content.advancedPlaceholder},stepAttribute(){return!this.isFocused&&this.inputType==="number"?"any":this.step},min(){return this.type==="date"?this.content.minDate:this.content.min},max(){return this.type==="date"?this.content.maxDate:this.content.max}},watch:{"content.value"(e){this.type==="decimal"&&(e=this.formatValue(e)),e!==this.value&&(this.setValue(e),this.$emit("trigger-event",{name:"initValueChange",event:{value:e}}))},isReadonly:{immediate:!0,handler(e){e?this.$emit("add-state","readonly"):this.$emit("remove-state","readonly"),this.$nextTick(()=>{this.handleObserver()})}},"content.timePrecision"(e){typeof this.value=="string"&&(e===3600?this.setValue(this.value.slice(0,2)):e===60?this.setValue(this.value.slice(0,5)):e===1&&this.setValue(this.value.slice(0,8)))},"content.type"(){this.$nextTick(()=>{this.handleObserver()})},inputRef(){this.$nextTick(()=>{this.handleObserver()})},isReallyFocused(e,t){e&&!t?this.$emit("trigger-event",{name:"focus"}):!e&&t&&this.$emit("trigger-event",{name:"blur"})},isFocused:{immediate:!0,handler(e){e?this.$emit("add-state","focus"):this.$emit("remove-state","focus")}},"content.advancedPlaceholder":{async handler(e){this.$nextTick(()=>{this.handleObserver()})}}},beforeUnmount(){this.resizeObserverContent&&this.resizeObserverContent.disconnect(),this.resizeObserverBorder&&this.resizeObserverBorder.disconnect(),wwLib.getFrontDocument().removeEventListener("keyup",this.onKeyEnter)},mounted(){this.isMounted=!0,this.handleObserver(),wwLib.getFrontDocument().addEventListener("keyup",this.onKeyEnter),this.value!==this.$refs.input.value&&(this.$refs.input.value=this.value)},methods:{handleManualInput(e){const t=e.target.value;let n;if(!(this.inputType==="number"&&(e.data==="."||e.data===",")&&t==="")){if(this.inputType==="number"&&(t===0||t&&t.length))try{n=parseFloat(t)}catch{n=t}else n=t;n!==this.value&&(this.setValue(n),this.content.debounce?(this.isDebouncing=!0,this.debounce&&clearTimeout(this.debounce),this.debounce=setTimeout(()=>{this.$emit("trigger-event",{name:"change",event:{domEvent:e,value:n}}),this.isDebouncing=!1},this.delay)):this.$emit("trigger-event",{name:"change",event:{domEvent:e,value:n}}))}},onKeyEnter(e){e.key==="Enter"&&this.isReallyFocused&&this.$emit("trigger-event",{name:"onEnterKey",event:{value:this.value}})},onBlur(e){this.correctDecimalValue(e),this.isReallyFocused=!1},correctDecimalValue(e){if(this.content.type==="decimal"){const t=this.formatValue(this.value);if(t===this.value)return;this.setValue(t),this.$emit("trigger-event",{name:"change",event:{domEvent:e,value:t}})}},handleObserver(){if(!this.isMounted)return;this.resizeObserverContent&&this.resizeObserverContent.disconnect(),this.resizeObserverBorder&&this.resizeObserverBorder.disconnect();const e=this.$refs.input;e&&(this.resizeObserverContent=new ResizeObserver(()=>{this.updatePosition(e)}),this.resizeObserverBorder=new ResizeObserver(()=>{this.updatePosition(e)}),this.resizeObserverContent.observe(e,{box:"content-box"}),this.resizeObserverBorder.observe(e,{box:"border-box"}))},updatePosition(e){const t=this.$refs.placeholder;if(!e||!t)return;this.noTransition=!0;const n=this.content.type==="textarea"?wwLib.wwUtils.getLengthUnit(e.style.paddingTop)[0]:e.clientHeight/2-t.clientHeight/2;this.placeholderPosition.top=n+"px",this.placeholderPosition.left=e.style.paddingLeft,setTimeout(()=>{this.noTransition=!1},wwLib.wwUtils.getLengthUnit(this.content.transition)[0])},focusInput(){if(this.isReadonly)return;const e=this.$refs.input;e&&e.focus()}}},O=["id","value","type","name","readonly","required","autocomplete","placeholder","min","max","step"],T=["id","value","type","name","readonly","required","placeholder","rows"];function P(e,t,n,s,r,i){const h=v("wwElement",!0);return u(),o("div",d({class:["ww-input-basic",{editing:i.isEditing}]},i.rootBinding),[n.content.type!=="textarea"?(u(),o("input",d({id:e.$attrs.id,key:"ww-input-basic-"+s.step,ref:"input"},i.inputBinding,{value:i.value,class:["ww-input-basic__input",[{hideArrows:n.content.hideArrows&&i.inputType==="number","date-placeholder":n.content.type==="date"&&!i.value,"-readonly":i.isReadonly},e.$attrs.class]],type:i.inputType,name:n.wwElementState.name,readonly:i.isReadonly,required:n.content.required,autocomplete:n.content.autocomplete?"on":"off",placeholder:i.isAdvancedPlaceholder?"":e.wwLang.getText(n.content.placeholder),style:i.style,min:i.min,max:i.max,step:i.stepAttribute,onInput:t[0]||(t[0]=a=>i.handleManualInput(a)),onBlur:t[1]||(t[1]=a=>i.onBlur(a)),onFocus:t[2]||(t[2]=a=>r.isReallyFocused=!0)}),null,16,O)):(u(),o("textarea",d({key:1,ref:"input",id:e.$attrs.id},i.inputBinding,{value:i.value,class:["ww-input-basic__input",e.$attrs.class],type:n.content.type,name:n.wwElementState.name,readonly:i.isReadonly,required:n.content.required,placeholder:i.isAdvancedPlaceholder?"":e.wwLang.getText(n.content.placeholder),style:[i.style,{resize:n.content.resize?"":"none"}],rows:n.content.rows,onInput:t[3]||(t[3]=a=>i.handleManualInput(a)),onFocus:t[4]||(t[4]=a=>r.isReallyFocused=!0),onBlur:t[5]||(t[5]=a=>r.isReallyFocused=!1)}),null,16,T)),i.isAdvancedPlaceholder?(u(),o("div",{key:2,ref:"placeholder",class:"ww-input-basic__placeholder",style:b(i.placeholderSyle),onClick:t[6]||(t[6]=(...a)=>i.focusInput&&i.focusInput(...a))},[w(h,d({style:{pointerevents:"none"}},n.content.placeholderElement,{states:i.value===0||i.value&&i.value.length?["active"]:[],"ww-props":{text:e.wwLang.getText(n.content.placeholder)}}),null,16,["states","ww-props"])],4)):y("",!0)],16)}const V=p(x,[["render",P],["__scopeId","data-v-ef6fd23f"]]);export{V as e};
