import{_ as T,D as l,c as d,o as c,a as n,H as o,aD as _,J as m,F as b,q as y,t as v}from"./main-BJCOn9SJ.js";const D={props:{plugin:{type:Object,required:!0},settings:{type:Object,required:!0}},emits:["update:settings"],data(){return{isLoading:!1,definitions:{}}},computed:{tablesOptions(){return Object.keys(this.definitions).map(e=>({label:e,value:e}))},realtimeTables(){var e;return((e=this.settings.publicData)==null?void 0:e.realtimeTables)||{}}},mounted(){var e,t,s;this.definitions=((t=(e=this.plugin)==null?void 0:e.doc)==null?void 0:t.definitions)||{},(s=this.settings.publicData)!=null&&s.realtimeTables||this.changeRealtimeTables({})},methods:{async fetchTables(){var e,t;try{this.isLoading=!0,await this.plugin.fetchDoc(),this.definitions=((t=(e=this.plugin)==null?void 0:e.doc)==null?void 0:t.definitions)||{}}catch(s){wwLib.wwLog.error(s)}finally{this.isLoading=!1}},updateReatimeTable(e,t){const s={...this.realtimeTables};s[e]=t;for(const r in s)this.tablesOptions.find(u=>u.value===r)||delete s[r];this.changeRealtimeTables(s)},changeRealtimeTables(e){this.$emit("update:settings",{...this.settings,publicData:{...this.settings.publicData,realtimeTables:e}}),this.subscribeTables(e)},subscribeTables(e){this.settings.publicData.realtimeTables&&this.plugin.subscribeTables(e)}}},E={class:"mb-3 label-sm text-blue-500 flex items-center"},L={class:"label-2 ml-2"};function k(e,t,s,r,u,a){const p=l("wwEditorIcon"),h=l("wwEditorInputSwitch"),f=l("wwEditorFormRow"),w=l("wwLoader");return c(),d(b,null,[n("div",E,[o(p,{class:"mr-1",name:"information-circle",small:""}),t[1]||(t[1]=_(" This feature allow your collections to be updated in realtime automcatically. You must enable realtime on your tables both in WeWeb and in Supabase in order to use this feature. "))]),o(f,{label:"Enable realtime table"},{"append-label":m(()=>[t[2]||(t[2]=n("a",{class:"ww-editor-link ml-2",href:"https://supabase.com/docs/guides/api#realtime-api-1",target:"_blank"}," Find it here ",-1)),n("button",{type:"button",class:"ww-editor-button -primary -small ml-auto",onClick:t[0]||(t[0]=(...i)=>a.fetchTables&&a.fetchTables(...i))},"refresh")]),default:m(()=>[(c(!0),d(b,null,y(a.tablesOptions,i=>(c(),d("div",{key:i.value,class:"flex items-center mb-2"},[o(h,{modelValue:a.realtimeTables[i.value],"onUpdate:modelValue":g=>a.updateReatimeTable(i.value,g),small:""},null,8,["modelValue","onUpdate:modelValue"]),n("div",L,v(i.label),1)]))),128))]),_:1}),o(w,{loading:u.isLoading},null,8,["loading"])],64)}const R=T(D,[["render",k]]);export{R as default};
