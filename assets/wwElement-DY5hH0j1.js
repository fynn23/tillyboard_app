import{_ as b,D as h,c as o,o as l,a as C,F as w,H as f,m as S,e as D,r as V,w as R,aA as j,I as O,j as g,b as c,q as v,J as q,S as U,n as k,d as y,L as I,M as A}from"./main-BLqjW_kE.js";const x={props:{id:{type:void 0,required:!0},editContainer:{type:Object,required:!0},editingContainer:{type:Object,required:!0},edit:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1}},emits:["update:edit","validate","delete","cancel"],methods:{onEditContainerEvent(t){t.type==="click"&&(t.index===0?this.$emit("update:edit",!this.edit):this.$emit("delete"))},onEditingContainerEvent(t){t.type==="click"&&(t.index===0?this.$emit("validate"):this.$emit("cancel"))},onIsEditContainerSelected(t){t&&this.edit&&this.$emit("update:edit",!1)},onIsEditingContainerSelected(t){t&&!this.edit&&this.$emit("update:edit",!0)}}},H={class:"ww-data-grid-action-cell"};function T(t,n,e,r,s,i){const u=h("wwElement");return l(),o("td",null,[C("div",H,[(l(),o(w,{key:1},[f(u,S({class:{"hide-container":e.edit}},e.editContainer,{"ww-props":{isFixed:!0},onElementEvent:i.onEditContainerEvent,"onUpdate:isSelected":i.onIsEditContainerSelected,"onUpdate:childSelected":i.onIsEditContainerSelected}),null,16,["class","onElementEvent","onUpdate:isSelected","onUpdate:childSelected"]),f(u,S({class:{"hide-container":!e.edit}},e.editingContainer,{"ww-props":{isFixed:!0},onElementEvent:i.onEditingContainerEvent,"onUpdate:isSelected":i.onIsEditingContainerSelected,"onUpdate:childSelected":i.onIsEditingContainerSelected}),null,16,["class","onElementEvent","onUpdate:isSelected","onUpdate:childSelected"])],64))])])}const z=b(x,[["render",T]]),p={expose:["internalValue","column","resetValue"],props:{column:{type:Object,required:!0},item:{type:Object,required:!0},columnsElement:{type:Object,required:!0},editableCustomColumnsElement:{type:Object,required:!0},edit:{type:Boolean,default:!1},rowUniqueId:{required:!0,type:String}},setup(t){const n=D(()=>{if(t.column)return _.get(t.item,t.column.path)}),e=V(n.value),r=V(n.value);return R(n,s=>{e.value=s}),R(j(t,"edit"),(s,i)=>{!i&&s&&(r.value=n.value)}),{setValue(s){e.value=s},internalValue:e,value:n,previousValue:r}},computed:{type(){return this.column?this.column.type==="custom"&&this.column.editable&&this.edit?this.column.editableType:this.column.type:null},element(){return this.column?this.column.type==="custom"&&this.column.editable&&this.edit&&this.editableCustomColumnsElement[this.column.id]?this.editableCustomColumnsElement[this.column.id]:this.columnsElement[this.column.id]:null},isMultiSelect(){return this.type==="multiselect"}},methods:{onElementEvent(t){(t.type==="update:value"||t.type==="update:currentSelection")&&this.setValue(t.value)},resetValue(){this.internalValue=this.previousValue}}},G={class:"ww-data-grid-cell"};function L(t,n,e,r,s,i){const u=h("wwElement");return l(),o("td",G,[O(t.$slots,"default"),i.element&&i.element.uid?(l(),g(u,{key:0,"ww-props":{[i.isMultiSelect?"currentSelection":"value"]:r.internalValue,readonly:!e.edit,attributes:e.edit?{form:e.rowUniqueId}:{}},uid:i.element.uid,onElementEvent:i.onElementEvent},null,8,["ww-props","uid","onElementEvent"])):c("",!0)])}const F=b(p,[["render",L]]),P={components:{DataGridActionCell:z,DataGridCell:F},props:{id:{type:void 0,required:!0},item:{type:Object,required:!0},columns:{type:Array,required:!0},columnsElement:{type:Object,required:!0},editableCustomColumnsElement:{type:Object,required:!0},isEditAvailable:{type:Boolean,default:!1},editContainer:{type:Object,required:!0},editingContainer:{type:Object,required:!0},selectCheckbox:{type:Object,required:!0},edit:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1}},emits:["update:edit","update:row","delete:row","update:is-selected"],data(){return{cellRefs:{},uniqueId:`form-row-${wwLib.wwUtils.getUid()}`}},methods:{onSubmit(){const t=_.cloneDeep(this.item);Object.values(this.cellRefs).forEach(n=>{n.column&&n.column.type!=="custom"&&_.set(t,n.column&&n.column.path,_.cloneDeep(n.internalValue))}),this.$emit("update:row",{value:t,id:this.id,cancel:()=>{Object.values(this.cellRefs).forEach(n=>{n.resetValue()})}}),this.$emit("update:edit",!1)},onValidate(){const t=Array.isArray(this.$refs.form)?this.$refs.form[0]:this.$refs.form;t?t.checkValidity()?this.onSubmit():t.reportValidity():this.onSubmit()},onDelete(){this.$emit("delete:row",{id:this.id,value:this.item})},onCancel(){Object.values(this.cellRefs).forEach(t=>{t.resetValue()}),this.$emit("update:edit",!1)},registerCellRef(t,n){n&&(this.cellRefs[t]=n)}}},M={key:0},N=["id"],W={key:1,class:"message ww-typo-sub-text flex items-center"};function J(t,n,e,r,s,i){const u=h("wwElement"),E=h("DataGridCell"),B=h("DataGridActionCell");return l(),o("tr",{class:k({bgSelected:e.isSelected})},[e.selectable?(l(),o("td",M,[f(u,S(e.selectCheckbox,{states:e.isSelected?["checked"]:[],onClick:n[0]||(n[0]=d=>t.$emit("update:is-selected",!e.isSelected))}),null,16,["states"])])):c("",!0),(l(!0),o(w,null,v(e.columns,(d,a)=>(l(),o(w,{key:d.id},[d.display?(l(),g(E,{key:0,ref_for:!0,ref:m=>i.registerCellRef(d.id,m),column:d,item:e.item,edit:d.editable&&e.edit,"columns-element":e.columnsElement,"editable-custom-columns-element":e.editableCustomColumnsElement,"row-unique-id":s.uniqueId},{default:q(()=>[e.edit&&a===0?(l(),o("form",{key:0,id:s.uniqueId,ref_for:!0,ref:"form",hidden:"",onSubmit:n[1]||(n[1]=U((...m)=>i.onSubmit&&i.onSubmit(...m),["prevent"]))},null,40,N)):c("",!0)]),_:2},1032,["column","item","edit","columns-element","editable-custom-columns-element","row-unique-id"])):c("",!0)],64))),128)),!e.columns||!e.columns.length?(l(),o("span",W," Please define a column ")):c("",!0),e.isEditAvailable?(l(),g(B,{key:2,id:e.id,"is-editing":e.isEditing,"edit-container":e.editContainer,"editing-container":e.editingContainer,edit:e.edit,"onUpdate:edit":n[2]||(n[2]=d=>t.$emit("update:edit",d)),onValidate:i.onValidate,onDelete:i.onDelete,onCancel:i.onCancel},null,8,["id","is-editing","edit-container","editing-container","edit","onValidate","onDelete","onCancel"])):c("",!0)],2)}const K=b(P,[["render",J]]),Q={components:{DataGridRow:K},props:{content:{type:Object,required:!0},uid:{type:String,required:!0},wwFrontState:{type:Object,required:!0}},emits:["update:content","update:content:effect","trigger-event"],setup(t){const{value:n,setValue:e}=wwLib.wwVariable.useComponentVariable({uid:t.uid,name:"selectedRows",defaultValue:[],type:"Array",readonly:!0,resettable:!0}),{value:r,setValue:s}=wwLib.wwVariable.useComponentVariable({uid:t.uid,name:"sort",defaultValue:{name:null,order:"ASC"},type:"Object"});return{selectedRows:n,setSelectedRows:e,columnsSort:r,setColumnsSort:s}},data(){return{editingId:void 0}},computed:{isEditing(){return!1},cssVars(){return{"--headerBgColor":this.content.headerBackgroundColor,"--rowBgColor":this.content.rowBackgroundColor,"--rowBgColorAlt":this.content.alternateBackground?this.content.rowBackgroundColorAlt:this.content.rowBackgroundColor,...this.content.rowBackgroundColorHover?{"--rowBgColorHover":this.content.rowBackgroundColorHover}:{},...this.content.rowBackgroundColorSelected?{"--rowBgColorSelected":this.content.rowBackgroundColorSelected}:{},"--verticalAlignement":this.content.verticalAlignement,"--theadBordersVertical":this.content.isTheadBorderSplit?this.content.theadBordersVertical:this.content.theadBorders,"--theadBordersHorizontal":this.content.isTheadBorderSplit?this.content.theadBordersHorizontal:this.content.theadBorders,"--thBordersVertical":this.content.isThBorderSplit?this.content.thBordersVertical:this.content.thBorders,"--thBordersHorizontal":this.content.isThBorderSplit?this.content.thBordersHorizontal:this.content.thBorders,"--trBordersVertical":this.content.isTrBorderSplit?this.content.trBordersVertical:this.content.trBorders,"--trBordersHorizontal":this.content.isTrBorderSplit?this.content.trBordersHorizontal:this.content.trBorders,"--tdBordersVertical":this.content.isTdBorderSplit?this.content.tdBordersVertical:this.content.tdBorders,"--tdBordersHorizontal":this.content.isTdBorderSplit?this.content.tdBordersHorizontal:this.content.tdBorders}},forcedInlineEditing(){return!1},isAllSelected(){const t=wwLib.wwCollection.getCollectionData(this.content.data);return Array.isArray(t)?t.every((n,e)=>this.selectedRows.some(({id:r})=>r===this.getRowId(n,e))):!1}},watch:{},methods:{getRowId(t,n){return _.get(t,this.content.dataIdPath,n)},setEdit(t,n){this.editingId=t?n:void 0},getIsSelected(t){return!t||!Array.isArray(this.selectedRows)?!1:this.selectedRows.some(n=>n&&n.id===t)},updateRowSelection(t,n){const e=this.getRowId(n);if(!e)return;const r=this.getIsSelected(e);t&&!r?this.setSelectedRows([...this.selectedRows,{id:e,value:n}]):!t&&r&&this.setSelectedRows([...this.selectedRows].filter(s=>s&&s.id!==e))},async toggleSort(t,n){if(!t.sortable)return;const e=t.name||n,r=e===this.columnsSort.name&&this.columnsSort.order==="ASC"?"DESC":"ASC";await this.setColumnsSort({name:e,key:t.path,order:r}),this.$emit("trigger-event",{name:"sort",event:{order:r,name:e}})},toggleAllSelection(){const t=wwLib.wwCollection.getCollectionData(this.content.data);if(!Array.isArray(t)){this.setSelectedRows([]);return}this.isAllSelected?this.setSelectedRows([]):this.setSelectedRows(t.map(n=>({value:n,id:this.getRowId(n)})))}}},X={key:0},Y={key:0},Z={class:"columnHeader"},$={key:0},ee={class:"columnHeader"};function te(t,n,e,r,s,i){const u=h("wwElement",!0),E=h("DataGridRow"),B=h("wwLayout");return l(),o("table",{class:k(["ww-data-grid",{sticky:e.content.hasStickyHeader}]),style:y(i.cssVars),cellpadding:"0",cellspacing:"0"},[C("colgroup",null,[e.content.selectable?(l(),o("col",{key:0,style:y({width:e.content.selectColumnWidth||"auto"})},null,4)):c("",!0),(l(!0),o(w,null,v(e.content.columns,(d,a)=>(l(),o(w,{key:a},[d.display?(l(),o("col",{key:0,style:y({width:d.width||"auto"})},null,4)):c("",!0)],64))),128)),e.content.inlineEditing?(l(),o("col",{key:1,style:y({width:e.content.actionColumnWidth||"auto"})},null,4)):c("",!0)]),e.content.displayHeader?(l(),o("thead",X,[e.content.selectable?(l(),o("th",Y,[C("div",Z,[f(u,I(A(e.content.headerTextSelectable)),null,16),f(u,S(e.content.selectCheckbox,{states:i.isAllSelected?["checked"]:[],onClick:i.toggleAllSelection}),null,16,["states","onClick"])])])):c("",!0),(l(!0),o(w,null,v(e.content.columns,(d,a)=>(l(),o(w,{key:a},[d.display?(l(),o("th",$,[C("div",ee,[e.content.headerTextElements[d.id]?(l(),g(u,{key:0,uid:e.content.headerTextElements[d.id].uid},null,8,["uid"])):c("",!0),e.content.sortIcon&&d.sortable?(l(),g(u,{key:1,uid:e.content.sortIcon.uid,class:k({"-reversed":r.columnsSort.order==="DESC"&&r.columnsSort.name===(d.name||a)}),states:r.columnsSort.name===(d.name||a)?["active"]:"",onClick:m=>i.toggleSort(d,a)},null,8,["uid","class","states","onClick"])):c("",!0)])])):c("",!0)],64))),128)),e.content.inlineEditing?(l(),o("th",{key:1,style:y({width:e.content.actionColumnWidth||"auto"})},[f(u,I(A(e.content.headerTextActions)),null,16)],4)):c("",!0)])):c("",!0),f(B,{path:"data",tag:"tbody",class:"body","disable-edit":""},{default:q(({index:d,data:a})=>[(l(),g(E,{id:i.getRowId(a),key:i.getRowId(a,d),class:"grid-row",item:a,columns:e.content.columns,"columns-element":e.content.columnsElement,"editable-custom-columns-element":e.content.editableCustomColumnsElement,"is-edit-available":e.content.inlineEditing,"is-editing":i.isEditing,edit:i.forcedInlineEditing&&d===0||e.content.inlineEditing&&s.editingId!==void 0&&i.getRowId(a)===s.editingId,"edit-container":e.content.editContainer,"editing-container":e.content.editingContainer,"select-checkbox":e.content.selectCheckbox,selectable:e.content.selectable,"is-selected":i.getIsSelected(i.getRowId(a)),"onUpdate:edit":m=>i.setEdit(m,i.getRowId(a)),"onUpdate:row":n[0]||(n[0]=m=>t.$emit("trigger-event",{name:"update:row",event:m})),"onDelete:row":n[1]||(n[1]=m=>t.$emit("trigger-event",{name:"delete:row",event:m})),"onUpdate:isSelected":m=>i.updateRowSelection(m,a,i.getRowId(a))},null,8,["id","item","columns","columns-element","editable-custom-columns-element","is-edit-available","is-editing","edit","edit-container","editing-container","select-checkbox","selectable","is-selected","onUpdate:edit","onUpdate:isSelected"]))]),_:1})],6)}const ie=b(Q,[["render",te],["__scopeId","data-v-c953fd98"]]);export{ie as e};
