import{s as v}from"./default.css_vue_type_style_index_0_src_true_lang-B5IiUGYZ.js";import{_ as y,r as L,q as h,j as m,o as p,m as a,c as O,s as u,a as g,Q as S,u as s,d as C,b as _,e as f,p as V}from"./main-BEqSrhKB.js";const F={props:{option:{type:Object,required:!0},layoutType:{type:String,required:!0},textElement:{type:Object,required:!0},flexboxElement:{type:Object,required:!0}},setup(){return{observer:null,optionStates:L([])}},mounted(){const e=this.$el.parentElement;e&&(this.observer=new MutationObserver(t=>{for(const i of t){const l=i.target.getAttribute(i.attributeName);this.$nextTick(()=>{this.handleOntionState(l)})}}),this.observer.observe(e,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}))},methods:{handleOntionState(e){!e||typeof e!="string"||(e.includes("is-pointed")&&!e.includes("is-selected")?this.optionStates=[":hover"]:!e.includes("is-pointed")&&e.includes("is-selected")?this.optionStates=["Selected"]:e.includes("is-pointed")&&e.includes("is-selected")?this.optionStates=["Selected:hover"]:this.optionStates=[])}},beforeUnmount(){this.observer&&this.observer.disconnect()}};function T(e,t,i,l,d,n){const r=h("wwElement");return i.layoutType==="text"?(p(),m(r,a({key:0,class:"multiselect-single-label-el"},i.textElement,{"ww-props":{text:i.option.label||""},states:l.optionStates}),null,16,["ww-props","states"])):(p(),m(r,a({key:1,class:"multiselect-single-label-el free-layout"},i.flexboxElement,{states:l.optionStates}),null,16,["states"]))}const I=y(F,[["render",T]]),k="label",P="value",j={components:{Multiselect:v,OptionItem:I},props:{uid:{type:String,required:!0},content:{type:Object,required:!0},wwElementState:{type:Object,required:!0}},emits:["trigger-event","update:content","update:content:effect","add-state","remove-state"],setup(e){const{value:t,setValue:i}=wwLib.wwVariable.useComponentVariable({uid:e.uid,name:"value",type:"string",defaultValue:f(()=>e.content.initialValue??"")}),l=V("componentStyle"),d=f(()=>l.cursor);return{currentSelection:t,setCurrentSelection:i,cursor:d}},data:()=>({options:[],componentKey:0}),computed:{currentLang(){return wwLib.wwLang.lang},isEditing(){return!1},selectProps(){return{closeOnSelect:this.content.closeOnSelect,searchable:this.content.searchable,required:this.content.required,disabled:this.content.disabled,placeholder:"placeholder",noOptionsText:this.content.noOptionsText,noResultsText:this.content.noResultsText,canClear:this.content.clearIcon,canDeselect:this.content.canDeselect,caret:this.content.caretIcon,name:this.wwElementState.name,options:this.options,infinite:this.content.infiniteScroll,limit:this.content.limitedOptions?this.content.limit:-1,resolveOnLoad:!1,locale:this.currentLang}},internalValue:{get(){return this.content.allowCreation&&this.currentSelection&&!this.options.some(e=>e.value===this.currentSelection)&&this.options.push(this.formatOption(this.currentSelection)),this.currentSelection},set(e){this.setCurrentSelection(e),this.$emit("trigger-event",{name:"change",event:{domEvent:{},value:e}})}},placeholder(){return wwLib.wwLang.getText(this.content.placeholder)},valueLabel(){const e=this.options.find(t=>t.value==this.internalValue);return e?wwLib.wwLang.getText(e.label):this.internalValue},defaultOptionStyle(){return{backgroundColor:this.content.optionsDefaultBgColor,color:this.content.optionsDefaultTextColor}},cssVariables(){return{"--ms-dropdown-bg":this.content.dropdownBackgroundColor,"--ms-dropdown-border-width":this.content.dropdownBorderWidth||"0px","--ms-dropdown-border-color":this.content.dropdownBorderColor,"--ms-dropdown-radius":this.content.dropdownBorderRadius||"0px","--ms-max-height":this.content.dropdownMaxHeight||"10rem","--ms-option-bg-pointed":"transparent","--ms-option-bg-selected":"transparent","--ms-option-bg-selected-pointed":"transparent","--ms-option-color-pointed":"#000000","--ms-option-color-selected":"#000000","--ms-option-color-selected-pointed":"#000000","--ms-ring-width":"0px","--ms-ring-color":"transparent","--ms-spinner-color":this.content.loadingRingColor,"--search-font-size":this.content.searchFontSize||"inherit","--search-font-family":this.content.searchFontFamily||"inherit","--search-font-color":this.content.searchFontColor||"inherit","--component-cursor":this.cursor||"pointer"}},isReadonly(){return this.wwElementState.props.readonly===void 0?this.content.readonly:this.wwElementState.props.readonly}},watch:{textStyle(){return wwLib.getTextStyleFromContent(this.content)},async"content.initialValue"(e){this.init(),await this.$nextTick(),this.setCurrentSelection(e),this.$emit("trigger-event",{name:"initValueChange",event:{value:e}})},"content.options":{deep:!0,handler(){this.init()}},"content.layoutType"(){this.init()},"content.labelField"(){this.init()},"content.valueField"(){this.init()},currentLang(){this.componentKey+=1,this.$nextTick(()=>{this.init()})},isReadonly:{immediate:!0,handler(e){e?this.$emit("add-state","readonly"):this.$emit("remove-state","readonly")}},"content.limit"(){this.componentKey+=1,this.$nextTick(()=>{this.init()})}},created(){this.init()},methods:{async init(){this.options=[];const e=Array.isArray(this.content.options)?[...this.content.options]:[];this.options.push(...e.map(t=>this.formatOption(t))),this.content.initialValue!==void 0&&this.content.allowCreation&&!this.options.some(t=>t===this.content.initialValue||t.value===this.content.initialValue)&&this.options.push(this.formatOption(this.content.initialValue))},getValueIndex(e){return this.options.findIndex(t=>t.value===e.value)},getOptionIndex(e){return this.options.indexOf(e)},formatOption(e){const t=this.content.labelField||k,i=this.content.valueField||P;let l=wwLib.resolveObjectPropertyPath(e,t);const d=wwLib.resolveObjectPropertyPath(e,i);return typeof l!="object"&&(l=wwLib.resolveObjectPropertyPath(e,wwLib.wwLang.getText(t))),this.content.layoutType==="free"?{label:l,value:d,data:e}:typeof e=="object"?{label:l,value:d,image:wwLib.resolveObjectPropertyPath(e,"image"),style:{backgroundColor:wwLib.resolveObjectPropertyPath(e,"bgColor")||"#FFFFFF00",color:wwLib.resolveObjectPropertyPath(e,"textColor")||"#000000"},data:e}:{label:e,value:e}},getLabel(e){return!e||e.label===void 0||e.label===null?"":`${wwLib.wwLang.getText(e.label)}`},handleOpening(e){this.$refs.select&&(e?this.$refs.select.open():this.$refs.select.close())},checkIsOpen(){},clear(){this.isEditing||(this.internalValue="")},interceptFocus(e){this.isEditing&&e.target.classList.contains("multiselect-wrapper")&&(e.stopPropagation(),e.preventDefault())}}},q={key:1,class:"multiselect-single-label-readonly"};function B(e,t,i,l,d,n){const r=h("wwElement",!0),w=h("wwText"),b=h("wwLayoutItemContext"),x=h("OptionItem"),E=h("Multiselect");return n.isReadonly?(p(),O("div",q,[s(w,{text:n.valueLabel},null,8,["text"]),n.internalValue?(p(),m(r,a({key:0,style:{opacity:"0","pointer-events":"none"}},i.content.clearIconElement),null,16)):_("",!0),s(r,a({style:{opacity:"0","pointer-events":"none"}},i.content.caretIconElement),null,16)])):(p(),m(E,a({ref:"select",key:e.componentKey,modelValue:n.internalValue,"onUpdate:modelValue":t[4]||(t[4]=o=>n.internalValue=o),class:["ww-input-select",{editing:n.isEditing}],mode:"single",style:n.cssVariables,classes:{containerOpen:"is-open",containerOpenTop:"is-open-top"}},n.selectProps,{onClose:n.checkIsOpen,onFocusCapture:n.interceptFocus,onFocusinCapture:n.interceptFocus}),{placeholder:u(()=>[s(r,a({class:"multiselect-placeholder-el"},i.content.placeholderElement,{"ww-props":{text:n.placeholder||""}}),null,16,["ww-props"])]),singlelabel:u(({value:o})=>[g("div",{class:"multiselect-single-label",style:C(o.style||n.defaultOptionStyle)},[s(b,{index:c=>n.getValueIndex(c),item:{},"is-repeat":"",data:{...o,label:n.getLabel(o)}},{default:u(()=>[s(w,{class:"multiselect-single-label-el",text:n.getLabel(o)},null,8,["text"])]),_:2},1032,["index","data"])],4)]),option:u(({option:o})=>[s(b,{index:c=>n.getOptionIndex(c),item:{},"is-repeat":"",data:{...o,label:n.getLabel(o)}},{default:u(()=>[s(x,{option:{...o,label:n.getLabel(o)},layoutType:i.content.layoutType,flexboxElement:i.content.flexboxElement,imageElement:i.content.imageElement,textElement:i.content.textElement,onMousedown:t[0]||(t[0]=c=>n.isEditing&&c.stopPropagation()),onClick:t[1]||(t[1]=c=>n.isEditing&&c.stopPropagation())},null,8,["option","layoutType","flexboxElement","imageElement","textElement"])]),_:2},1032,["index","data"])]),caret:u(()=>[s(r,a(i.content.caretIconElement,{onMousedown:t[2]||(t[2]=o=>n.isEditing&&o.stopPropagation())}),null,16)]),clear:u(()=>[g("div",{onMousedown:t[3]||(t[3]=S(()=>{},["stop"])),style:{zIndex:2}},[s(r,a(i.content.clearIconElement,{onClick:n.clear}),null,16,["onClick"])],32)]),_:1},16,["modelValue","style","class","onClose","onFocusCapture","onFocusinCapture"]))}const A=y(j,[["render",B],["__scopeId","data-v-3830fdcc"]]);export{A as e};
